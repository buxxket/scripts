#!/usr/bin/env python

import pandas as pd
import sys
from pathlib import Path


def excel_to_csv(file_path):
    xls = pd.ExcelFile(file_path)
    out_dir = Path(file_path).stem + "_csv"
    Path(out_dir).mkdir(exist_ok=True)

    for sheet_name in xls.sheet_names:
        df = pd.read_excel(file_path, sheet_name=sheet_name)
        csv_path = Path(out_dir) / f"{sheet_name}.csv"
        df.to_csv(csv_path, index=False)
        print(f"Saved {csv_path}")


if __name__ == "__main__":
    if len(sys.argv) < 2:
        print("Usage: excel2csv <file.xlsx>")
        sys.exit(1)
    excel_to_csv(sys.argv[1])
